async function e(e=location.href,t=`body`,n=`push`){let r=document.querySelector(t);r?.setAttribute(`aria-busy`,`true`);let i=await fetch(e,{headers:{"htswap-target":t}}),a=new DOMParser().parseFromString(await i.text(),`text/html`),o=a.querySelector(t);if(!o||!r)return console.error(`HTSWAP: Target "${t}" not found`);r.outerHTML=o.outerHTML,n===`push`?history.pushState({target:t},``,e):n===`replace`&&history.replaceState({target:t},``,e)}function t(){document.querySelectorAll(`[target]:not([data-htswap-locked]):not([target^="_"])`).forEach(t=>{t.setAttribute(`data-htswap-locked`,`true`),t instanceof HTMLAnchorElement?t.onclick=n=>{n.preventDefault(),e(t.getAttribute(`href`)||void 0,t.getAttribute(`target`)||void 0,t.getAttribute(`data-htswap-history`)||void 0)}:t instanceof HTMLFormElement&&(t.onsubmit=n=>{n.preventDefault();let r=t.getAttribute(`action`)||location.href,i=new URLSearchParams(new FormData(t)).toString();e(r+(r.includes(`?`)?`&`:`?`)+i,t.getAttribute(`target`)||void 0,t.getAttribute(`data-htswap-history`)||void 0)})})}function n(){t(),new MutationObserver(t).observe(document.documentElement,{childList:!0,subtree:!0}),window.addEventListener(`popstate`,t=>e(void 0,t.state?.target,`none`))}n();export{t as htswapAssign,n as htswapInit,e as htswapReplace};